\chapter{Modelo y propuesta de Investigación}

\section{Modelo de Investigación}
El trabajo de investigación está dividido en 6 etapas de las cuales se van a describir a continuación:
\begin{itemize}
\item La primera etapa consiste en conseguir 1500 imágenes de todas las clases de esfericidad y redondez para poder entrenar de manera equitativa la red, y después probar con las imágenes de (Krumbein, 1941) y verificar los resultados.
\item La segunda etapa se obtiene el valor de redondez y esfericidad de cada una de las imágenes de entrenamiento con los métodos propuestos.
\item La tercera etapa se saca el valor de las constantes de los primeros 40 armónicos de la serie de Fourier elíptico de cada una de las imágenes de entrenamiento, aparte, relacionar estos armónicos con su valor de esfericidad y redondez.
\item La cuarta etapa consiste entrenar las 2 redes neuronales, la que va a clasificar la esfericidad, y la que va a clasificar la redondez, con los valores de entrada que será los armónicos de Fourier elíptico y su respectiva salida.
\item Una vez entrenada cada red, obtener los armónicos de Fourier elíptico de las imágenes de prueba.
\item La última etapa es clasificar las imágenes de prueba y observar los resultados.
\end{itemize}

\begin{figure}[H]
	\centering 
	\includegraphics[scale=1]{figuras/modeloInvestigacion.png}
	\caption{Modelo de Investigación}
\end{figure}

\section{Fourier elíptico}

Los coeficientes de Fourier han sido muy utilizados para caracterizar contornos cerrados. Fourier elíptico es una manera simple de obtener los coeficientes de Fourier del código de cadena de un contorno cerrado. Los coeficientes resultantes son invariantes a la escala, rotación y traslación.

El código de cadena es el primer paso en Fourier elíptico, fue descrito inicialmente por \cite{freeman1974computer}, aproximando un contorno cerrado por una secuencia en partes con 8 posibles valores. El código de un contorno es la cadena \(V\) de longitud \(K\)

\begin{equation}
V = a_1a_2a_3...a_K,
\end{equation}

donde cada unión \(a_i\) es un entero del 0 al 7 orientado en la dirección \((\frac{\pi}{r})a_i\).[\cite{Kuhl1982}]

En la figura 3.2 se puede observar como un contorno cerrado separado en píxeles, se puede obtener el código de cadena, trazando una trayectoria desde un punto inicial, hasta volver a llegar a ese mismo punto, pasando por todo el contorno. El código de cadena de la figura 3.2a iniciando de el extremo superior izquierdo es:

\begin{equation}
V = 0005676644422123
\end{equation}

\begin{figure}[H]
	\centering 
	\includegraphics[scale=1]{codigoCadena.png}
	\caption{Representación gráfica del código de cadena de un contorno cerrado [\cite{Kuhl1982}]}
\end{figure}

Debido a que el cambio en el código de cadena esa constante y no varía, los coeficientes pueden ser encontrados más fácilmente. Por lo que los coeficientes de la componente \(x\) son:

\begin{equation}
a_n = \frac{T}{2n^2\pi^2}\sum_{p = 1}^{K}\frac{\Delta x_p}{\Delta t_p}[\cos{\frac{2n\pi t_p}{T}} - \cos{\frac{2n\pi t_{p-1}}{T}}]
\end{equation}

\begin{equation}
b_n = \frac{T}{2n^2\pi^2}\sum_{p = 1}^{K}\frac{\Delta x_p}{\Delta t_p}[\sin{\frac{2n\pi t_p}{T}} - \sin{\frac{2n\pi t_{p-1}}{T}}]
\end{equation}

donde, la K es el número de píxeles del contorno, \(T\) el período fundamental, \(\Delta x_p\) el cambio en el eje de las x, \(\Delta t_p\) el cambio en el tiempo, que básicamente va a ser 1 constante.

Con eso obtendríamos los coeficientes de la componente \(x\), pero como una imagen es una señal en dos dimensiones necesitamos también obtener los coeficientes de la componente \(y\).

\begin{equation}
c_n = \frac{T}{2n^2\pi^2}\sum_{p = 1}^{K}\frac{\Delta y_p}{\Delta t_p}[\cos{\frac{2n\pi t_p}{T}} - \cos{\frac{2n\pi t_{p-1}}{T}}]
\end{equation}

\begin{equation}
d_n = \frac{T}{2n^2\pi^2}\sum_{p = 1}^{K}\frac{\Delta y_p}{\Delta t_p}[\sin{\frac{2n\pi t_p}{T}} - \sin{\frac{2n\pi t_{p-1}}{T}}]
\end{equation}

Con eso ya se tendría los coeficientes necesarios, debido a que el cambio de la \(x\) no siempre sera igual al cambio en las \(y\), Fourier elíptico generaría elipses en vez de círculos como el método tradicional.

Para que este método obtenga la invarianza a la escala, rotación y traslación, es necesario aplicar una normalización y ajustar los ángulos en los que va a iniciar cada elipse, para que independientemente la escala, rotación y traslación que tenga el contorno cerrado, siempre de el mismo resultado.

\begin{equation}
E_p = ((A_0-x_p)^2 + (C_0-y_p)^2)^\frac{1}{2}
\end{equation}

donde \(A_0\) y \(C_0\) son el promedio de la energía de las componentes \(x\) y \(y\) respectivamente. Para obtener el ángulo de rotación inicial \(\theta_p\) a el índice \(p\):

\begin{equation}
\theta_p = \frac{2\pi t_p}{T}, 0<\theta_p\le2\pi
\end{equation}

y para obtener el ángulo de rotación espacial \(\psi_p\)

\begin{equation}
\psi_p=\arctan[\frac{y_p-C_0}{x_p-A_0}], 0\le\psi_p<2\pi
\end{equation}

Al iniciar el cálculo de los coeficientes, se tendría que obtener \(E_1\), \(\theta_1\) y \(\psi_1\) para influir en los siguiente coeficientes a que se reajusten de acuerdo a estos ángulos iniciales, y dividirlo entre \(E_0\) para mantener la invarianza a la escala, por lo que la obtención de los nuevos coeficientes sería:

\begin{equation}
\begin{bmatrix}
1a^{**}_n & 1b^{**}_n\\
1c^{**}_n & 1d^{**}_n
\end{bmatrix} =
\begin{bmatrix}
\cos{\psi_1} & \sin{\psi_1}\\
-\sin{\psi_1} & \cos{\psi_1}
\end{bmatrix}
\begin{bmatrix}
a_n & b_n\\
c_n & d_n
\end{bmatrix}
\begin{bmatrix}
\cos{n\theta_1} & -\sin{n\theta_1}\\
\sin{n\theta_1} & \cos{n\theta_1}
\end{bmatrix}
\end{equation}

\begin{equation}
\begin{bmatrix}
2a^{**}_n & 2b^{**}_n\\
2c^{**}_n & 2d^{**}_n
\end{bmatrix} =
(-1)^{n+1}
\begin{bmatrix}
1a^{**}_n & 1b^{**}_n\\
1c^{**}_n & 1d^{**}_n
\end{bmatrix}
\end{equation}

El resultado de la ecuación 3.11 nos daría los coeficientes \(a,b,c,d\) para el \(n\) armónico que se está calculando. Siendo invariante a la escala, rotación y traslación. Para más información, consultar \cite{Kuhl1982}.
\section{Algoritmo para estimar la redondez}
\section{Redes neuronales}

